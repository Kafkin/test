"use strict";(self["webpackChunkstandart_project"]=self["webpackChunkstandart_project"]||[]).push([[267],{5117:function(e,t,a){var r=a(6330),n=TypeError;e.exports=function(e,t){if(!delete e[t])throw n("Cannot delete property "+r(t)+" of "+r(e))}},541:function(e,t,a){var r=a(2109),n=a(7908),s=a(6244),i=a(3658),l=a(5117),o=a(7207),d=1!==[].unshift(0),u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},h=d||!u();r({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(e){var t=n(this),a=s(t),r=arguments.length;if(r){o(a+r);var d=a;while(d--){var u=d+r;d in t?t[u]=t[d]:l(t,u)}for(var h=0;h<r;h++)t[h]=arguments[h]}return i(t,a+r)}})},2267:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var r=a(6252);const n={class:"page admin"},s={class:"admin__container-btn"},i={class:"admin__container-btn"},l={class:"admin__container-btn"};function o(e,t,a,o,d,u){const h=(0,r.up)("v-table"),c=(0,r.up)("v-accordion");return(0,r.wg)(),(0,r.iD)("section",n,[(0,r.Wm)(c,{header:["Товары","Категории","Возраст. ограничения"]},{1:(0,r.w5)((()=>[(0,r.Wm)(h,{header:[{width:"250px",type:"text",edit:!0,name:"Название",path:"title",subpath:null,prefix:null},{width:"450px",type:"text",edit:!0,name:"Описание",path:"description",subpath:null,prefix:null},{type:"img",edit:!0,name:"Картинка",path:"img",subpath:null,prefix:null},{type:"list",edit:!1,name:"Возраст",path:"ageLimit",subpath:"name",prefix:"+",list:e.getAllAgeLimit,head:[{name:"Номер",path:"id",subpath:null,prefix:null},{name:"Название",path:"name",subpath:null,prefix:null},{name:"Цвет",path:"color",subpath:null,prefix:null}]},{type:"list",edit:!1,name:"Кратегория",path:"category",subpath:"name",prefix:null,list:e.getAllCategory,head:[{name:"Номер",path:"id",subpath:null,prefix:null},{name:"Название",path:"name",subpath:null,prefix:null},{name:"Цвет",path:"color",subpath:null,prefix:null}]},{type:"number",edit:!0,name:"Количество",path:"quantityStore",subpath:null,prefix:null},{type:"number",edit:!0,name:"Цена за шт",path:"price",subpath:null,prefix:"$"}],body:e.getAllProduct,ref:"tableProduct"},null,8,["header","body"]),(0,r._)("div",s,[(0,r._)("button",{class:"admin__btn",onClick:t[0]||(t[0]=(...e)=>u.deleteProduct&&u.deleteProduct(...e))},"УДАЛИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[1]||(t[1]=t=>e.$refs.tableProduct.addNewRow())},"ДОБАВИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[2]||(t[2]=(...e)=>u.saveProduct&&u.saveProduct(...e))},"СОХРАНИТЬ")])])),2:(0,r.w5)((()=>[(0,r.Wm)(h,{header:[{name:"Номер",path:"id",subpath:null,prefix:null},{type:"text",edit:!0,name:"Название",path:"name",subpath:null,prefix:null},{type:"text",edit:!0,name:"Цвет",path:"color",subpath:null,prefix:null}],body:e.getAllCategory,ref:"tableCategory"},null,8,["body"]),(0,r._)("div",i,[(0,r._)("button",{class:"admin__btn",onClick:t[3]||(t[3]=(...e)=>u.deleteCategory&&u.deleteCategory(...e))},"УДАЛИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[4]||(t[4]=t=>e.$refs.tableCategory.addNewRow())},"ДОБАВИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[5]||(t[5]=(...e)=>u.saveCategory&&u.saveCategory(...e))},"СОХРАНИТЬ")])])),3:(0,r.w5)((()=>[(0,r.Wm)(h,{header:[{name:"Номер",path:"id",subpath:null,prefix:null},{type:"number",edit:!0,name:"Название",path:"name",subpath:null,prefix:null},{type:"text",edit:!0,name:"Цвет",path:"color",subpath:null,prefix:null}],body:e.getAllAgeLimit,ref:"tableAgeLimit"},null,8,["body"]),(0,r._)("div",l,[(0,r._)("button",{class:"admin__btn",onClick:t[6]||(t[6]=(...e)=>u.deleteAgeLimit&&u.deleteAgeLimit(...e))},"УДАЛИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[7]||(t[7]=t=>e.$refs.tableAgeLimit.addNewRow())},"ДОБАВИТЬ"),(0,r._)("button",{class:"admin__btn",onClick:t[8]||(t[8]=(...e)=>u.saveAgeLimit&&u.saveAgeLimit(...e))},"СОХРАНИТЬ")])])),_:1},8,["header"])])}var d=a(3577);const u={class:"accordion"},h={class:"accordion__container-btn"},c=["onClick"],p={class:"accordion__container-info"};function b(e,t,a,n,s,i){return(0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("div",h,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.header,((t,a)=>((0,r.wg)(),(0,r.iD)("button",{key:a,onClick:t=>e.curSlot=a+1,class:"accordion__btn"},(0,d.zw)(t),9,c)))),128))]),(0,r._)("div",p,[(0,r.WI)(e.$slots,e.curSlot)])])}var g={name:"vAccordion",props:{header:{required:!0,type:Array}},data:()=>({curSlot:1}),watch:{},methods:{},computed:{},created(){}},m=a(3744);const w=(0,m.Z)(g,[["render",b]]);var f=w,y=a(2423),_=a(3907),v={name:"AdminView",data:()=>({}),watch:{},methods:{...(0,_.nv)(["deleteCategoryInDb","deleteAgeLimitInDb","deleteProductInDb","updateDbCategory","updateDbAgeLimit","updateDbProduct"]),...(0,_.OI)(["setError"]),saveProduct(){const e=this.$refs.tableProduct.renderData();e?.message?this.setError(e):this.updateDbProduct(e)},saveCategory(){const e=this.$refs.tableCategory.renderData();e?.message?this.setError(e):this.updateDbCategory(e)},saveAgeLimit(){const e=this.$refs.tableAgeLimit.renderData();e?.message?this.setError(e):this.updateDbAgeLimit(e)},deleteProduct(){const e=this.$refs.tableProduct.deleteRow();e?.message?this.setError(e):this.deleteProductInDb(e)},deleteCategory(){const e=this.$refs.tableCategory.deleteRow();e?.message?this.setError(e):this.deleteCategoryInDb(e)},deleteAgeLimit(){const e=this.$refs.tableAgeLimit.deleteRow();e?.message?this.setError(e):this.deleteAgeLimitInDb(e)}},computed:{...(0,_.Se)(["getAllProduct","getAllCategory","getAllAgeLimit"])},components:{"v-accordion":f,"v-table":y.Z},created(){}};const x=(0,m.Z)(v,[["render",o]]);var D=x},2423:function(e,t,a){a.d(t,{Z:function(){return D}});var r=a(6252),n=a(3577),s=a(9963);const i={id:"my-table"},l=["onDragstart","onDragenter","onDragleave","onDrop"],o=["onDblclick"],d=["value","onKeypress","type"];function u(e,t,a,u,h,c){const p=(0,r.up)("v-list");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("table",i,[(0,r._)("thead",null,[(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.head,(e=>((0,r.wg)(),(0,r.iD)("th",{key:e},(0,n.zw)(e.name),1)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.rows,((a,i)=>((0,r.wg)(),(0,r.iD)("tr",{key:i,class:(0,n.C_)({active:e.dropIndex===i,edit:a.editable}),onDragstart:e=>!a.editable&&c.dragStart(i,e),onDragenter:(0,s.iM)((e=>c.dragEnter(i)),["prevent"]),onDragleave:e=>c.dragLeave(i),onDrop:(0,s.iM)((e=>c.drop(i)),["prevent"]),onDragend:t[0]||(t[0]=e=>c.dragEnd(e)),onDragover:t[1]||(t[1]=(0,s.iM)((()=>{}),["prevent"])),draggable:!0},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.head,((e,t)=>((0,r.wg)(),(0,r.iD)("td",{onDblclick:(0,s.iM)((t=>!0===e.edit&&c.startEdit(a,e.path,i)),["prevent"]),key:t},[(0,r.wy)((0,r._)("p",{class:"text",style:(0,n.j5)({width:e?.width})},(0,n.zw)(e.subpath?a[e.path]?.[e.subpath]:a[e.path])+(0,n.zw)(e.prefix),5),[[s.F8,!a.editable]]),(0,r.wy)((0,r._)("input",{value:e.subpath?a[e.path]?.[e.subpath]:a[e.path],onKeypress:[(0,s.D2)((0,s.iM)((e=>c.stopEdit(a,i)),["prevent"]),["enter"]),(0,s.D2)((0,s.iM)((e=>c.stopResetEdit(a)),["prevent"]),["esc"])],autofocuss:"true",type:e.type,ref_for:!0,ref:e.path},null,40,d),[[s.F8,a.editable&&!0===e.edit]]),a.editable&&"list"===e.type?((0,r.wg)(),(0,r.j4)(p,{key:0,ref_for:!0,ref:`list-${t}`,onSelectRow:c.selectRow,cIndex:t,head:e.head,rows:e.list,path:e.path,rIndex:i,row:a},null,8,["onSelectRow","cIndex","head","rows","path","rIndex","row"])):(0,r.kq)("",!0)],40,o)))),128))],42,l)))),128))])])])}a(541);var h=a(3907);const c={class:"list"},p={key:0,class:"list__body"},b={class:"list__table"},g=["onClick"];function m(e,t,a,s,i,l){return(0,r.wg)(),(0,r.iD)("div",c,[(0,r._)("p",{class:"list__title",onClick:t[0]||(t[0]=t=>e.show=!0)},"показать список"),e.show?((0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("table",b,[(0,r._)("thead",null,[(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.head,(e=>((0,r.wg)(),(0,r.iD)("th",{key:e},(0,n.zw)(e.name),1)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.rows,((t,s)=>((0,r.wg)(),(0,r.iD)("tr",{key:s},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.head,((a,s)=>((0,r.wg)(),(0,r.iD)("td",{onClick:a=>e.$emit("selectRow",this.row,this.rIndex,this.cIndex,this.path,t),key:s},(0,n.zw)(a.subpath?t[a.path]?.[a.subpath]:t[a.path])+(0,n.zw)(a.prefix),9,g)))),128))])))),128))])]),(0,r._)("button",{class:"list__btn",onClick:t[1]||(t[1]=t=>e.show=!1)},"Выйти")])):(0,r.kq)("",!0)])}var w={name:"vList",props:{head:{required:!0,type:Array},rows:{required:!0,type:Array},path:{required:!0,type:String},cIndex:{required:!0,type:Number},rIndex:{required:!0,type:Number},row:{required:!0,type:Object}},data:()=>({show:!1}),watch:{},methods:{close(){this.show=!1}},computed:{},components:{},created(){}},f=a(3744);const y=(0,f.Z)(w,[["render",m]]);var _=y,v={name:"vTable",props:{header:{required:!0,type:Array},body:{required:!0,type:Array}},data:()=>({dragIndex:null,dropIndex:null,head:[],rows:[]}),methods:{...(0,h.OI)(["setError"]),dragStart(e,t){this.dragIndex=e,t.dataTransfer.setData("text/plain",e)},dragEnd(){this.dragIndex=null,this.dropIndex=null},dragEnter(e){null!==this.dragIndex&&e!==this.dragIndex&&(this.dropIndex=e)},dragLeave(e){this.dropIndex===e&&(this.dropIndex=null)},drop(){if(null!==this.dropIndex){const e=this.rows[this.dragIndex];this.rows.splice(this.dragIndex,1),this.rows.splice(this.dropIndex,0,e),this.dragIndex=null,this.dropIndex=null}},startEdit(e,t,a){this.rows.map(((e,t)=>{!0===e.editable&&this.stopEdit(e,t)})),e.editable=!0,this.$nextTick((()=>{this.$refs[t][a].focus()}))},stopEdit(e,t){this.head.forEach((({path:e,subpath:a,edit:r})=>{r&&(a?this.rows[t][e][a]=this.$refs[e][t].value:this.rows[t][e]=this.$refs[e][t].value)})),e.editable=!1},stopResetEdit(e){e.editable=!1},selectRow(e,t,a,r,n){this.$refs[`list-${a}`][0].close(),e[r]=n,this.head.forEach((({path:e,subpath:a,edit:r})=>{r&&(a?this.rows[t][e][a]=this.$refs[e][t].value:this.rows[t][e]=this.$refs[e][t].value)}))},addNewRow(){const e=this.rows.find((e=>e.new));if(e)return void this.setError({message:{success:["У вас уже есть один добавленный но не сохраненный элемент. Сохраните и добавляйте новые!"]},code:401});const t={index:null,...this.rows[0],new:!0};Object.keys(t).forEach((e=>{t[e]="editable"!==e&&("new"===e||null)})),console.log(t),this.rows.unshift(t),this.setError({message:{success:["Новая строка добавлена в таблицу (^-^)"]},code:200})},renderData(){return this.rows.some((e=>e.editable))?{message:{success:["Нельзя сохранить данные в режиме редоктирования"]},code:401}:(setTimeout((()=>{this.tableMounted()}),1500),this.rows)},deleteRow(){const e=this.rows.find((e=>e.editable));return e?(setTimeout((()=>{this.tableMounted()}),1500),e):{message:{success:["Невозможно удалить не выбранную строку"]},code:401}},tableMounted(){this.rows=this.body.map((e=>({...e,editable:!1,editField:null})))}},components:{"v-list":_},created(){this.head=this.header,this.rows=this.body},mounted(){this.tableMounted()}};const x=(0,f.Z)(v,[["render",u]]);var D=x}}]);
//# sourceMappingURL=267.64d65678.js.map